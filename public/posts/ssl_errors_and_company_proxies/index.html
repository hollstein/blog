<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>SSL errors and company proxies | blog</title>
<meta name="keywords" content="SSL, python">
<meta name="description" content="Developing AI / ML application behind company IT infrastructure can be challenging. When developing prototypes or quickly checking the latest models from the Huggingface hub, I&rsquo;m often struck by SSL errors. Often, the only way out for the moment it to disable SSL locally for specific actions, also: Don&rsquo;t do this outside of quick experiments or in production systems.
An excellent resource for dealing with these errors  is this Stack Overflow thread: https://stackoverflow.com/questions/15445981/how-do-i-disable-the-security-certificate-check-in-python-requests">
<meta name="author" content="">
<link rel="canonical" href="http://example.org/posts/ssl_errors_and_company_proxies/">
<link crossorigin="anonymous" href="http://example.org/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css" integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://example.org/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://example.org/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://example.org/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://example.org/apple-touch-icon.png">
<link rel="mask-icon" href="http://example.org/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://example.org/posts/ssl_errors_and_company_proxies/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="http://example.org/posts/ssl_errors_and_company_proxies/">
  <meta property="og:site_name" content="blog">
  <meta property="og:title" content="SSL errors and company proxies">
  <meta property="og:description" content="Developing AI / ML application behind company IT infrastructure can be challenging. When developing prototypes or quickly checking the latest models from the Huggingface hub, I’m often struck by SSL errors. Often, the only way out for the moment it to disable SSL locally for specific actions, also: Don’t do this outside of quick experiments or in production systems.
An excellent resource for dealing with these errors is this Stack Overflow thread: https://stackoverflow.com/questions/15445981/how-do-i-disable-the-security-certificate-check-in-python-requests">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-06-03T13:52:10+02:00">
    <meta property="article:modified_time" content="2023-06-03T13:52:10+02:00">
    <meta property="article:tag" content="Ssl">
    <meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SSL errors and company proxies">
<meta name="twitter:description" content="Developing AI / ML application behind company IT infrastructure can be challenging. When developing prototypes or quickly checking the latest models from the Huggingface hub, I&rsquo;m often struck by SSL errors. Often, the only way out for the moment it to disable SSL locally for specific actions, also: Don&rsquo;t do this outside of quick experiments or in production systems.
An excellent resource for dealing with these errors  is this Stack Overflow thread: https://stackoverflow.com/questions/15445981/how-do-i-disable-the-security-certificate-check-in-python-requests">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://example.org/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "SSL errors and company proxies",
      "item": "http://example.org/posts/ssl_errors_and_company_proxies/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "SSL errors and company proxies",
  "name": "SSL errors and company proxies",
  "description": "Developing AI / ML application behind company IT infrastructure can be challenging. When developing prototypes or quickly checking the latest models from the Huggingface hub, I\u0026rsquo;m often struck by SSL errors. Often, the only way out for the moment it to disable SSL locally for specific actions, also: Don\u0026rsquo;t do this outside of quick experiments or in production systems.\nAn excellent resource for dealing with these errors is this Stack Overflow thread: https://stackoverflow.com/questions/15445981/how-do-i-disable-the-security-certificate-check-in-python-requests\n",
  "keywords": [
    "SSL", "python"
  ],
  "articleBody": "Developing AI / ML application behind company IT infrastructure can be challenging. When developing prototypes or quickly checking the latest models from the Huggingface hub, I’m often struck by SSL errors. Often, the only way out for the moment it to disable SSL locally for specific actions, also: Don’t do this outside of quick experiments or in production systems.\nAn excellent resource for dealing with these errors is this Stack Overflow thread: https://stackoverflow.com/questions/15445981/how-do-i-disable-the-security-certificate-check-in-python-requests\nJust for reference, I’m reproducing Blenders answer here and show how to use it. What makes this one so good, is that it implements a solution as a context manager which isolates turning off SSL to specific code blocks:\nimport warnings import contextlib import requests from urllib3.exceptions import InsecureRequestWarning old_merge_environment_settings = requests.Session.merge_environment_settings @contextlib.contextmanager def no_ssl_verification(): opened_adapters = set() def merge_environment_settings(self, url, proxies, stream, verify, cert): # Verification happens only once per connection so we need to close # all the opened adapters once we're done. Otherwise, the effects of # verify=False persist beyond the end of this context manager. opened_adapters.add(self.get_adapter(url)) settings = old_merge_environment_settings(self, url, proxies, stream, verify, cert) settings['verify'] = False return settings requests.Session.merge_environment_settings = merge_environment_settings try: with warnings.catch_warnings(): warnings.simplefilter('ignore', InsecureRequestWarning) yield finally: requests.Session.merge_environment_settings = old_merge_environment_settings for adapter in opened_adapters: try: adapter.close() except: pass An example of using transformers:\nfrom transformers import AutoTokenizer, AutoModelForSeq2SeqLM with no_ssl_verification(): tokenizer = AutoTokenizer.from_pretrained(\"[MODEL NAME]\") model = AutoModelForSeq2SeqLM.from_pretrained(\"[MODEL NAME]\") ",
  "wordCount" : "227",
  "inLanguage": "en",
  "datePublished": "2023-06-03T13:52:10+02:00",
  "dateModified": "2023-06-03T13:52:10+02:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://example.org/posts/ssl_errors_and_company_proxies/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://example.org/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://example.org/" accesskey="h" title="blog (Alt + H)">blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://example.org/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://example.org/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      SSL errors and company proxies
    </h1>
    <div class="post-meta"><span title='2023-06-03 13:52:10 +0200 CEST'>June 3, 2023</span>

</div>
  </header> 
  <div class="post-content"><p>Developing AI / ML application behind company IT infrastructure can be challenging. When developing prototypes or quickly checking the latest models from the Huggingface hub, I&rsquo;m often struck by SSL errors. Often, the only way out for the moment it to disable SSL locally for specific actions, also: Don&rsquo;t do this outside of quick experiments or in production systems.</p>
<p>An excellent resource for dealing with these errors  is this Stack Overflow thread: <a href="https://stackoverflow.com/questions/15445981/how-do-i-disable-the-security-certificate-check-in-python-requests">https://stackoverflow.com/questions/15445981/how-do-i-disable-the-security-certificate-check-in-python-requests</a></p>
<p>Just for reference, I&rsquo;m reproducing Blenders answer here and show how to use it. What makes this one so good, is that it implements a solution as a context manager which isolates turning off SSL to specific code blocks:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> warnings
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> contextlib
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> urllib3.exceptions <span style="color:#f92672">import</span> InsecureRequestWarning
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>old_merge_environment_settings <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>Session<span style="color:#f92672">.</span>merge_environment_settings
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@contextlib.contextmanager</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">no_ssl_verification</span>():
</span></span><span style="display:flex;"><span>    opened_adapters <span style="color:#f92672">=</span> set()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">merge_environment_settings</span>(self, url, proxies, stream, verify, cert):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Verification happens only once per connection so we need to close</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># all the opened adapters once we&#39;re done. Otherwise, the effects of</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># verify=False persist beyond the end of this context manager.</span>
</span></span><span style="display:flex;"><span>        opened_adapters<span style="color:#f92672">.</span>add(self<span style="color:#f92672">.</span>get_adapter(url))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        settings <span style="color:#f92672">=</span> old_merge_environment_settings(self, url, proxies, stream, verify, cert)
</span></span><span style="display:flex;"><span>        settings[<span style="color:#e6db74">&#39;verify&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> settings
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    requests<span style="color:#f92672">.</span>Session<span style="color:#f92672">.</span>merge_environment_settings <span style="color:#f92672">=</span> merge_environment_settings
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> warnings<span style="color:#f92672">.</span>catch_warnings():
</span></span><span style="display:flex;"><span>            warnings<span style="color:#f92672">.</span>simplefilter(<span style="color:#e6db74">&#39;ignore&#39;</span>, InsecureRequestWarning)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">yield</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">finally</span>:
</span></span><span style="display:flex;"><span>        requests<span style="color:#f92672">.</span>Session<span style="color:#f92672">.</span>merge_environment_settings <span style="color:#f92672">=</span> old_merge_environment_settings
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> adapter <span style="color:#f92672">in</span> opened_adapters:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                adapter<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">pass</span>
</span></span></code></pre></div><p>An example of using transformers:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> transformers <span style="color:#f92672">import</span> AutoTokenizer, AutoModelForSeq2SeqLM
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> no_ssl_verification():
</span></span><span style="display:flex;"><span>    tokenizer <span style="color:#f92672">=</span> AutoTokenizer<span style="color:#f92672">.</span>from_pretrained(<span style="color:#e6db74">&#34;[MODEL NAME]&#34;</span>)
</span></span><span style="display:flex;"><span>    model <span style="color:#f92672">=</span> AutoModelForSeq2SeqLM<span style="color:#f92672">.</span>from_pretrained(<span style="color:#e6db74">&#34;[MODEL NAME]&#34;</span>)
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://example.org/tags/ssl/">Ssl</a></li>
      <li><a href="http://example.org/tags/python/">Python</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://example.org/">blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
